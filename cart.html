<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>STACKLY Cart | Manage Your Order</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />
    <script src="https://unpkg.com/lucide@latest"></script>

    <link rel="stylesheet" href="./cart.css" />
  </head>

  <body>
    <!-- Header / Fixed Navbar -->
    <header class="header">
      <a href="./home2.html" class="logo-link">
        <div class="logo-img"><img src="./file/logo.webp" alt="" /></div>
      </a>

      <!-- Desktop Navigation -->
      <nav class="nav-links-desktop" aria-label="Main Navigation Desktop">
        <ul class="nav-list-desktop">
          <li class="nav-item-desktop" aria-haspopup="true">
            <a href="./home2.html" class="nav-link-desktop">HOME</a>
            <ul class="dropdown-desktop">
              <li><a href="./index.html">HOME1</a></li>
            </ul>
          </li>
          <li class="nav-item-desktop">
            <a href="./service.html" class="nav-link-desktop">SERVICES</a>
          </li>
          <li class="nav-item-desktop">
            <a href="./faq.html" class="nav-link-desktop">FAQs</a>
          </li>
          <li class="nav-item-desktop" aria-haspopup="true">
            <a href="./about2.html" class="nav-link-desktop">ABOUT</a>
            <ul class="dropdown-desktop">
              <li><a href="./about2.html">About US</a></li>
              <li><a href="./career.html">CAREERS</a></li>
            </ul>
          </li>
          <li class="nav-item-desktop">
            <a href="./blog2.html" class="nav-link-desktop">BLOG</a>
          </li>
          <li class="nav-item-desktop">
            <a href="./contact2.html" class="nav-link-desktop">CONTACT</a>
          </li>
          <li class="nav-item-desktop shop-btn-desktop">
            <a href="./shop.html" class="shop-btn-link">SHOP</a>
          </li>
        </ul>
      </nav>

      <!-- Mobile Menu Toggle Button -->
      <button
        class="menu-toggle"
        aria-controls="mobile-menu"
        aria-expanded="false"
        aria-label="Toggle Navigation"
      >
        <span class="menu-toggle-line"></span>
        <span class="menu-toggle-line"></span>
        <span class="menu-toggle-line"></span>
      </button>
    </header>

    <!-- Mobile Slide-in Navigation -->
    <nav id="mobile-menu" class="nav-mobile" aria-label="Mobile Navigation">
      <ul class="nav-list-mobile">
        <li class="nav-item-mobile">
          <a
            class="nav-link-mobile dropdown-toggle"
            data-dropdown="home-dropdown"
            role="button"
            aria-expanded="false"
            aria-controls="home-dropdown"
            href="./home2.html"
          >
            HOME
            <span class="dropdown-arrow"></span>
          </a>
          <ul id="home-dropdown" class="dropdown-mobile">
            <li><a href="./index.html">HOME1</a></li>
          </ul>
        </li>

        <li class="nav-item-mobile">
          <a href="./service.html" class="nav-link-mobile">SERVICES</a>
        </li>

        <li class="nav-item-mobile">
          <a href="./faq.html" class="nav-link-mobile">FAQs</a>
        </li>

        <li class="nav-item-mobile">
          <a
            class="nav-link-mobile dropdown-toggle"
            data-dropdown="about-dropdown"
            role="button"
            aria-expanded="false"
            aria-controls="about-dropdown"
            href="./about2.html"
          >
            ABOUT
            <span class="dropdown-arrow"></span>
          </a>
          <ul id="about-dropdown" class="dropdown-mobile">
            <li><a href="./about2.html">About US</a></li>
            <li><a href="./career.html">CAREERS</a></li>
          </ul>
        </li>

        <li class="nav-item-mobile">
          <a href="./blog2.html" class="nav-link-mobile">BLOG</a>
        </li>

        <li class="nav-item-mobile">
          <a href="./contact2.html" class="nav-link-mobile">CONTACT</a>
        </li>
        <li class="nav-item-mobile">
          <a href="./shop.html" class="shop-btn-mobile">SHOP</a>
        </li>
      </ul>
    </nav>

    <!-- Overlay for closing the mobile menu -->
    <div class="overlay"></div>
    <div class="min-h-screen pt-8 pb-16">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <!-- Header -->
        <header class="text-center mb-12 reveal">
          <h1
            class="text-5xl font-extrabold mb-2"
            style="color: var(--primary-color)"
          >
            Your Shopping Cart
          </h1>
          <p class="text-xl text-gray-600" style="color: salmon">
            Review and manage your selected medicines.
          </p>
          <a
            href="shop.html"
            class="inline-flex items-center text-sm font-medium mt-4 p-2 rounded-full hover:bg-gray-200 transition"
            style="color: var(--primary-color)"
          >
            <i data-lucide="arrow-left" class="w-4 h-4 mr-1"></i> Continue
            Shopping
          </a>
        </header>

        <div class="lg:grid lg:grid-cols-3 lg:gap-8">
          <!-- Cart Items List (Col 1-2 on Desktop) -->
          <section class="lg:col-span-2 reveal">
            <div id="cart-items-container" class="space-y-6">
              <!-- Cart items will be rendered here -->
              <div
                id="empty-cart-message"
                class="bg-white p-8 rounded-xl shadow-lg text-center"
              >
                <i
                  data-lucide="package-open"
                  class="w-16 h-16 mx-auto mb-4"
                  style="color: var(--accent-color)"
                ></i>
                <p class="text-xl text-gray-600">
                  Your cart is feeling lonely!
                  <a
                    href="shop.html"
                    class="font-bold underline"
                    style="color: var(--primary-color)"
                    >Start adding medicines now.</a
                  >
                </p>
              </div>
            </div>
          </section>

          <!-- Cart Summary (Col 3 on Desktop) -->
          <aside
            class="lg:col-span-1 mt-12 lg:mt-0 sticky top-4 reveal"
            style="align-self: flex-start"
          >
            <div
              id="cart-summary-card"
              class="bg-white p-6 rounded-2xl shadow-2xl"
              style="border-top: 5px solid var(--primary-color)"
            >
              <h2
                class="text-3xl font-bold mb-6"
                style="color: var(--text-dark)"
              >
                Order Summary
              </h2>

              <!-- Totals -->
              <div class="mt-4 space-y-3">
                <div class="flex justify-between font-medium text-lg">
                  <span>Subtotal:</span>
                  <span id="cart-subtotal">$0.00</span>
                </div>
                <div class="flex justify-between text-md text-gray-600">
                  <span>Delivery Fee:</span>
                  <span id="cart-delivery-fee">$5.00</span>
                </div>
                <div
                  class="flex justify-between text-2xl font-extrabold pt-4 border-t"
                  style="border-color: var(--secondary-color)"
                >
                  <span>Total:</span>
                  <span id="cart-total" style="color: var(--secondary-color)"
                    >$5.00</span
                  >
                </div>
              </div>

              <!-- Checkout Button -->
              <a href="./404.html"
                ><button
                  class="w-full cta-button mt-6 text-xl"
                  disabled
                  id="checkout-button"
                >
                  Checkout Securely
                </button></a
              >
            </div>
          </aside>
        </div>
      </div>
    </div>
    <footer class="stackly-footer reveal-item" id="stackly-footer">
      <div class="footer-content">
        <!-- Top Section: Logo, Links, Address, Social -->
        <div class="footer-top">
          <!-- 1. Logo/Brand Section -->
          <div
            class="logo-section footer-section reveal-item"
            style="transition-delay: 0.2s"
          >
            <img src="./file/logo.webp" alt="" />
            <p>
              Your fast track to pharmaceutical delivery. Always reliable,
              always on time.
            </p>
          </div>

          <!-- 2. Quick Links -->
          <div
            class="links-section footer-section reveal-item"
            style="transition-delay: 0.4s"
          >
            <h3>Quick Links</h3>
            <ul>
              <li><a href="./home2.html">HOME</a></li>
              <li><a href="./service.html">SERVICES</a></li>
              <li><a href="./about2.html">ABOUT</a></li>
              <li><a href="./blog2.html">BLOG</a></li>
              <li><a href="./shop.html">SHOP</a></li>
            </ul>
          </div>

          <!-- 3. Company Address -->
          <div
            class="address-section footer-section reveal-item"
            style="transition-delay: 0.6s"
          >
            <h3>Our Headquarters</h3>
            <p>
              <strong>STACKLY Inc.</strong><br />
              1020 Innovation Drive,<br />
              New York, NY 10001, USA<br />
              <br />
            </p>
          </div>

          <!-- 4. Social Media Icons -->
          <div
            class="social-section footer-section reveal-item"
            style="transition-delay: 0.8s"
          >
            <h3>Follow Us</h3>
            <div class="social-icons">
              <a href="./404.html" aria-label="Facebook"
                ><i class="fab fa-facebook-f"></i
              ></a>
              <a href="./404.html" aria-label="Twitter"
                ><i class="fab fa-twitter"></i
              ></a>
              <a href="./404.html" aria-label="Instagram"
                ><i class="fab fa-instagram"></i
              ></a>
              <a href="./404.html" aria-label="LinkedIn"
                ><i class="fab fa-linkedin-in"></i
              ></a>
            </div>
          </div>
        </div>

        <!-- Bottom Section: Newsletter -->
        <div class="footer-bottom reveal-item" style="transition-delay: 1s">
          <h3>
            <span style="color: var(--text-highlight)">Stay Updated</span> with
            STACKLY
          </h3>
          <p>
            Subscribe to our newsletter for exclusive offers and health tips.
          </p>
          <form class="newsletter-form" action="./404.html">
            <input
              type="email"
              placeholder="Enter your email address"
              required
            />
            <button type="submit">Subscribe</button>
          </form>

          <!-- Copyright -->
          <div class="copyright">
            &copy; 2025 STACKLY Medicine Delivery. All rights reserved.
          </div>
        </div>
      </div>
    </footer>
    <script src="./nav2.js"></script>
    <script src="./footer2.js"></script>
    <script>
      lucide.createIcons();

      // --- Configuration & DOM Elements ---
      const CART_STORAGE_KEY = "stacklyCart";
      const DELIVERY_FEE = 5.0;

      const cartItemsContainer = document.getElementById(
        "cart-items-container"
      );
      const emptyCartMessageEl = document.getElementById("empty-cart-message");
      const cartSubtotalEl = document.getElementById("cart-subtotal");
      const cartTotalEl = document.getElementById("cart-total");
      const checkoutButton = document.getElementById("checkout-button");

      // --- Cart Management (uses LocalStorage) ---

      function getCart() {
        const storedCart = localStorage.getItem(CART_STORAGE_KEY);
        return storedCart ? JSON.parse(storedCart) : [];
      }

      function saveCart(cart) {
        localStorage.setItem(CART_STORAGE_KEY, JSON.stringify(cart));
        renderCart(); // Re-render after any change
      }

      function calculateTotals(cart) {
        const subtotal = cart.reduce(
          (sum, item) => sum + item.price * item.quantity,
          0
        );
        const total = subtotal > 0 ? subtotal + DELIVERY_FEE : 0.0;
        return { subtotal, total };
      }

      // --- Rendering ---

      function renderCart() {
        const cart = getCart();
        cartItemsContainer.innerHTML = "";

        if (cart.length === 0) {
          emptyCartMessageEl.style.display = "block";
          cartItemsContainer.appendChild(emptyCartMessageEl); // Ensure message is visible
          checkoutButton.disabled = true;
        } else {
          emptyCartMessageEl.style.display = "none";
          checkoutButton.disabled = false;

          cart.forEach((item) => {
            const itemTotal = item.price * item.quantity;
            const borderColor = item.color
              ? `#${item.color}`
              : "var(--primary-color)";

            const cartItemEl = document.createElement("div");
            cartItemEl.className =
              "bg-white p-4 sm:p-6 rounded-xl shadow-lg flex flex-col sm:flex-row items-center transition hover:shadow-xl";
            cartItemEl.style.borderLeft = `8px solid ${borderColor}`;

            // Image Placeholder
            const imagePlaceholderUrl = `https://placehold.co/100x60/${item.color}/ffffff?text=Pill`;

            cartItemEl.innerHTML = `
                        <!-- Product Image & Name -->
                        <div class="flex items-center w-full sm:w-1/2 mb-4 sm:mb-0">
                            <img src="${imagePlaceholderUrl}" alt="${
              item.name
            } Image Placeholder" class="w-16 h-10 object-cover rounded-md mr-4" onerror="this.onerror=null; this.src='https://placehold.co/100x60/cccccc/333333?text=Med';" />
                            <div>
                                <p class="font-bold text-lg" style="color: var(--text-dark);">${
                                  item.name
                                }</p>
                                <p class="text-sm text-gray-500 hidden sm:block">${item.description.substring(
                                  0,
                                  50
                                )}...</p>
                            </div>
                        </div>

                        <!-- Quantity Selector -->
                        <div class="flex items-center space-x-2 w-full sm:w-1/4 justify-center sm:justify-start">
                            <button data-id="${
                              item.id
                            }" data-action="decrease" class="qty-btn text-gray-500 hover:text-red-500 p-1">
                                <i data-lucide="minus-circle" class="w-5 h-5"></i>
                            </button>
                            <input type="number" value="${
                              item.quantity
                            }" min="1" readonly class="w-12 text-center border-none bg-gray-100 rounded-lg text-lg font-semibold" />
                            <button data-id="${
                              item.id
                            }" data-action="increase" class="qty-btn text-gray-500 hover:text-green-500 p-1">
                                <i data-lucide="plus-circle" class="w-5 h-5"></i>
                            </button>
                        </div>

                        <!-- Price & Remove -->
                        <div class="flex items-center space-x-4 w-full sm:w-1/4 justify-between sm:justify-end mt-4 sm:mt-0">
                            <span class="text-xl font-extrabold" style="color: var(--text-highlight);">$${itemTotal.toFixed(
                              2
                            )}</span>
                            <button data-id="${
                              item.id
                            }" data-action="remove" class="remove-btn text-gray-500 hover:text-red-600 p-1" aria-label="Remove item">
                                <i data-lucide="x" class="w-5 h-5"></i>
                            </button>
                        </div>
                    `;
            cartItemsContainer.appendChild(cartItemEl);
          });
        }

        // Update totals summary
        const { subtotal, total } = calculateTotals(cart);
        cartSubtotalEl.textContent = `$${subtotal.toFixed(2)}`;
        cartTotalEl.textContent = `$${total.toFixed(2)}`;

        lucide.createIcons(); // Re-initialize icons
        checkScrollReveal(); // Check for reveal
      }

      // --- Interaction Handlers ---

      function updateCartItem(productId, action) {
        const cart = getCart();
        const index = cart.findIndex((item) => item.id === productId);

        if (index === -1) return;

        if (action === "increase") {
          cart[index].quantity += 1;
        } else if (action === "decrease") {
          if (cart[index].quantity > 1) {
            cart[index].quantity -= 1;
          } else {
            cart.splice(index, 1); // Remove if quantity is 1
          }
        } else if (action === "remove") {
          cart.splice(index, 1);
        }

        saveCart(cart);
      }

      cartItemsContainer.addEventListener("click", (e) => {
        const button = e.target.closest("button[data-action]");
        if (button) {
          const productId = parseInt(button.dataset.id);
          const action = button.dataset.action;
          updateCartItem(productId, action);
        }
      });

      checkoutButton.addEventListener("click", () => {
        const cart = getCart();
        if (cart.length === 0) return;

        // Use a custom message box instead of alert()
        const { total } = calculateTotals(cart);
        const message = `Order totaling $${total.toFixed(
          2
        )} placed successfully! (Demo)`;

        const modal = document.createElement("div");
        modal.style.cssText =
          "position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.7);z-index:1000;display:flex;justify-content:center;align-items:center;";
        modal.innerHTML = `
                <div class="bg-white p-8 rounded-xl shadow-2xl max-w-sm w-full text-center transform scale-90 transition-all duration-300 ease-out" style="border-top: 5px solid var(--secondary-color);">
                    <i data-lucide="check-circle" class="w-12 h-12 mx-auto mb-4" style="color: var(--primary-color);"></i>
                    <p class="text-xl font-bold mb-4">${message}</p>
                    <button id="modal-close" class="cta-button">Done</button>
                </div>
            `;
        document.body.appendChild(modal);
        document.getElementById("modal-close").onclick = () =>
          document.body.removeChild(modal);
        lucide.createIcons();

        // Clear cart after checkout (demo)
        localStorage.removeItem(CART_STORAGE_KEY);
        renderCart();
      });

      // --- Scroll Reveal Logic (Duplicated for both files) ---
      const revealElements = document.querySelectorAll(".reveal");

      const observerOptions = {
        root: null,
        rootMargin: "0px",
        threshold: 0.1,
      };

      const observer = new IntersectionObserver((entries, observer) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            entry.target.classList.add("visible");
            observer.unobserve(entry.target);
          }
        });
      }, observerOptions);

      function checkScrollReveal() {
        document
          .querySelectorAll(".reveal:not(.visible)")
          .forEach((element) => {
            observer.observe(element);
          });
      }

      // --- Initialization ---
      document.addEventListener("DOMContentLoaded", () => {
        renderCart(); // Initial rendering of the cart
        checkScrollReveal();
      });
    </script>
  </body>
</html>
